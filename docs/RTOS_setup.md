# Setting Up FreeRTOS and Zephyr RTOS for Development with VS Code (Linux & macOS)

**WARNING** This file was generated by AI.  And not checked yet.  It probably is wrong.
This warning is not going away until all of it has been tested.

This guide details how to set up **FreeRTOS** and **Zephyr RTOS** for embedded development using **Visual Studio Code** on Linux and macOS. You'll find compiler requirements, environment setup, and VS Code configuration for both RTOSes.

---

## FreeRTOS Development Setup

### 1. Prerequisites

- **Compiler:**  
  - For ARM Cortex-M: [GNU Arm Embedded Toolchain](https://developer.arm.com/downloads/-/gnu-rm)
    - Linux: Install via package manager or download from Arm developer site.
    - macOS: Use [Homebrew](https://brew.sh/) (`brew install arm-none-eabi-gcc`) or download from Arm.
  - For RISC-V: [riscv-gcc toolchain](https://github.com/riscv/riscv-gnu-toolchain)
    - Build from source or use pre-built binaries.
  - For native POSIX simulation: GCC (Linux/macOS default).

- **CMake:** Recommended for project build management.
  - Install via package manager (`sudo apt install cmake` or `brew install cmake`).

- **VS Code Extensions:**
  - [C/C++](https://marketplace.visualstudio.com/items?itemName=ms-vscode.cpptools)
  - [CMake Tools](https://marketplace.visualstudio.com/items?itemName=ms-vscode.cmake-tools)
  - [Cortex-Debug](https://marketplace.visualstudio.com/items?itemName=marus25.cortex-debug) (if using J-Link/ST-Link debug probes)
  - [Makefile Tools](https://marketplace.visualstudio.com/items?itemName=ms-vscode.makefile-tools) (if using Makefiles)

### 2. FreeRTOS Source

- Download or clone [FreeRTOS Kernel](https://github.com/FreeRTOS/FreeRTOS-Kernel) and relevant demo or vendor port.
- Place your application and FreeRTOS source in your workspace.

### 3. Build System: CMake or Makefile

- Use provided CMake or Makefile scripts from demos, or create your own.
- Example Cortex-M CMake configuration:
    ```cmake
    cmake_minimum_required(VERSION 3.15)
    project(my_freertos_app C ASM)
    add_executable(my_app main.c freertos_kernel.c ...)
    set(CMAKE_C_COMPILER arm-none-eabi-gcc)
    ```

### 4. VS Code Configuration

- **Open Workspace:** Open your FreeRTOS project folder in VS Code.
- **Configure Build Tools:**
  - CMake Tools will auto-detect your CMakeLists.txt.
  - Set `"cmake.cmakePath"` and `"cmake.generator"` in `.vscode/settings.json` as needed.
  - For ARM builds, set `"cmake.toolchain"` to use your cross-toolchain file.

- **Debugger Setup:**  
  - For embedded targets, configure `launch.json` for the Cortex-Debug extension.
  - For POSIX simulation, you can use the built-in C/C++ debugger.

- **IntelliSense:**  
  - Ensure `c_cpp_properties.json` includes your toolchain's include paths.

---

## Zephyr RTOS Development Setup

### 1. Prerequisites

- **Compiler:**  
  - Zephyr uses **west** (meta-tool) and CMake for builds.
  - For ARM Cortex-M: Install GNU Arm Embedded Toolchain (`arm-none-eabi-gcc`)
  - For x86: Use GCC (default with Linux/macOS)
  - For RISC-V: Install riscv-gcc toolchain

- **Zephyr SDK:**  
  - [Download and install Zephyr SDK](https://docs.zephyrproject.org/latest/getting_started/index.html#install-the-zephyr-sdk)
  - Add SDK binaries to your PATH.

- **Python:**  
  - Zephyr build tools and west require Python 3.6+.
  - Install Python and pip:  
    - Linux: `sudo apt install python3 python3-pip`
    - macOS: `brew install python3`

- **west (Zephyr meta-tool):**
  - Install via pip: `pip3 install west`

- **VS Code Extensions:**
  - [C/C++](https://marketplace.visualstudio.com/items?itemName=ms-vscode.cpptools)
  - [CMake Tools](https://marketplace.visualstudio.com/items?itemName=ms-vscode.cmake-tools)
  - [NXP Zephyr Tools](https://marketplace.visualstudio.com/items?itemName=NXP.nxp-zephyr-extension-pack) (optional)
  - [Python](https://marketplace.visualstudio.com/items?itemName=ms-python.python)

### 2. Zephyr Source & Workspace

- Initialize workspace:
    ```bash
    west init my-zephyr-workspace
    cd my-zephyr-workspace
    west update
    ```
- Add your application to `my-zephyr-workspace/applications/`.

### 3. Build System

- Zephyr uses CMake via `west build`.  
- Example build command:
    ```bash
    west build -b nucleo_f401re applications/my_app
    ```
- Configure CMake Tools to use the `build/` directory and the appropriate board.

### 4. VS Code Configuration

- **Open Workspace:** Open Zephyr workspace in VS Code.
- **Configure CMake Tools:**  
  - Point to Zephyr's toolchain file or set up CMake presets.
- **Debug Configuration:**  
  - Use Cortex-Debug for ARM, or configure `launch.json` for your board/debugger.
- **IntelliSense:**  
  - Add Zephyr SDK include paths and Zephyr's `include/` directories to `c_cpp_properties.json`.

---

## Compiler Reference Table

| RTOS       | Target Arch      | Compiler           | Linux Install Command                | macOS Install Command         |
|------------|------------------|--------------------|--------------------------------------|-------------------------------|
| FreeRTOS   | ARM Cortex-M     | arm-none-eabi-gcc  | `sudo apt install gcc-arm-none-eabi` | `brew install arm-none-eabi-gcc` |
| FreeRTOS   | RISC-V           | riscv64-unknown-elf-gcc | Build from source or download      | Build from source or download  |
| FreeRTOS   | POSIX Sim        | gcc/clang          | Default                              | Default                       |
| Zephyr     | ARM Cortex-M     | arm-none-eabi-gcc  | `sudo apt install gcc-arm-none-eabi` | `brew install arm-none-eabi-gcc` |
| Zephyr     | x86              | gcc                | Default                              | Default                       |
| Zephyr     | RISC-V           | riscv64-unknown-elf-gcc | Build from source or download      | Build from source or download  |

---

## Additional Resources

- [FreeRTOS Official Documentation](https://www.freertos.org/Documentation/RTOS_book.html)
- [Zephyr Getting Started Guide](https://docs.zephyrproject.org/latest/getting_started/index.html)
- [GNU Arm Embedded Toolchain](https://developer.arm.com/downloads/-/gnu-rm)
- [VS Code C/C++ Extension Docs](https://code.visualstudio.com/docs/languages/cpp)

---

## Notes

- For both RTOSes, most embedded development targets cross-compilation (ARM, RISC-V).  
- For POSIX simulation/testing, you can use native GCC/Clang.
- Zephyr build system is more integrated; FreeRTOS requires you to pick or create your build system (CMake/Makefile).
- On macOS, you may need to install additional packages or use Homebrew for toolchains.

---

